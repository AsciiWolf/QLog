<!DOCTYPE html>
<html>

<head>
  <title>Online Map</title>
  <meta charset="utf8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
  <script src="https://foldynl.github.io/QLog/js/L.MaidenheadConfWorked.js"></script>
  <script src="https://unpkg.com/@joergdietrich/leaflet.terminator"></script>
  <script src="https://foldynl.github.io/QLog/js/heatmap.js"></script>
  <script src="https://foldynl.github.io/QLog/js/leaflet-heatmap.js"></script>
  <style>
    body {
      padding: 0;
      margin: 0;
    }
    html, body, #map {
      height: 100%;
    }
  </style>
</head>

<body>

  <div id="map"></div>

  <script>
    var mapOptions = {
             center: [0,0],
             zoom: 2,
             minZoom: 2,
    }

    var grids_worked = [];
    var grids_confirmed = [];
    var mylocations = [];
    var locations = [];
    var map = L.map('map', mapOptions);
    var greenIcon = new L.Icon({
      iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png',
      shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',
      iconSize: [25, 41],
      iconAnchor: [12, 41],
      popupAnchor: [1, -34],
      shadowSize: [41, 41]
    });

    var yellowIcon = new L.Icon({
      iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-gold.png',
      shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',
      iconSize: [25, 41],
      iconAnchor: [12, 41],
      popupAnchor: [1, -34],
      shadowSize: [41, 41]
    });

    var homeIcon = new L.Icon({
      iconUrl: 'https://img.icons8.com/officel/30/000000/radio-tower.png',
      iconSize: [50, 50],
      iconAnchor: [12, 41],
      popupAnchor: [1, -34]
    });

    L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
                {
                   attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a>'
                }).addTo(map);

    var maidenheadConfWorked = L.maidenheadConfWorked({color : 'rgba(255, 0, 0, 0.5)'}).addTo(map);
    var grayline = L.terminator({fillOpacity: 0.2})

    setInterval(function(){updateTerminator(grayline)}, 60000);

    function updateTerminator(grayline)
    {
       var t2 = L.terminator({fillOpacity: 0.2});
       grayline.setLatLngs(t2.getLatLngs());
       grayline.redraw();
    }

    var auroraCfg = {
      // radius should be small ONLY if scaleRadius is true (or small radius is intended)
      "radius": 2,
      "maxOpacity": .3,
      // scales the radius based on map zoom
      "scaleRadius": true,
      // if set to false the heatmap uses the global maximum for colorization
      // if activated: uses the data maximum within the current map boundaries
      //   (there will always be a red spot with useLocalExtremas true)
      "useLocalExtrema": false,
      // which field name in your data represents the latitude - default "lat"
      latField: 'lat',
      // which field name in your data represents the longitude - default "lng"
      lngField: 'lng',
      // which field name in your data represents the data value - default "value"
      valueField: 'count'
    };

    var auroraLayer = new HeatmapOverlay(auroraCfg);

    var pathLayer = L.layerGroup().addTo(map);

    function drawPath(points) {
        pathLayer.clearLayers();
        if ( points.length > 0 ) {
            var polyLine = new L.Polyline(points, {color: 'Fuchsia', weight: 3, opacity: 0.7, smoothFactor: 1 });
            pathLayer.addLayer(polyLine);
            var bounds = polyLine.getBounds();
            map.fitBounds(bounds);
            var center = bounds.getCenter();
            map.panTo(center);
        }
    }

    var markersLayer = L.layerGroup().addTo(map);

    function drawPoints(points) {
        markersLayer.clearLayers();
        points.forEach(function(point) {
           var marker = L.marker([point[1], point[2]], {
                        icon: point[3]})
                        .bindPopup(point[0]);
           markersLayer.addLayer(marker);
        });
     }

     function flyToPoint(point) {
        map.flyTo([point[1], point[2]],6);
     }

     var markersLayer2 = L.layerGroup().addTo(map);

     function drawPointsGroup2(points) {
        markersLayer2.clearLayers();
        points.forEach(function(point) {
           var marker = L.marker([point[1], point[2]], {
                        icon: point[3]})
                        .bindPopup(point[0]);
           markersLayer2.addLayer(marker);
        });
     }

  </script>

</body>

</html>
